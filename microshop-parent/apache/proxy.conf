<VirtualHost *:80>
    ServerName localhost

    ProxyPreserveHost On

    # Forward headers для Spring Security
    RequestHeader set X-Forwarded-Proto "http"
    RequestHeader set X-Forwarded-Port "8088"
    RequestHeader set X-Forwarded-Host "localhost:8088"

    # Product Service
    ProxyPass /api/products http://product-service:8081/api/products
    ProxyPassReverse /api/products http://product-service:8081/api/products

    # Order Service
    ProxyPass /api/orders http://order-service:8082/api/orders
    ProxyPassReverse /api/orders http://order-service:8082/api/products

    # Payment Service
    ProxyPass /api/payments http://payment-service:8083/api/payments
    ProxyPassReverse /api/payments http://payment-service:8083/api/payments

    # Логи для docker
    LogLevel proxy:debug
    CustomLog /dev/stdout "%t %h \"%r\" %>s %{Referer}i %{User-agent}i"
    ErrorLog /dev/stderr
</VirtualHost>

Alias /docs "/usr/local/apache2/htdocs/docs"

<Directory "/usr/local/apache2/htdocs/docs">
    Options Indexes FollowSymLinks
    AllowOverride None
    Require all granted
</Directory>
